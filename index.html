<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ZS Ferramenta - Avançado</title>
<style>
html, body { margin:0; padding:0; height:100%; font-family: Arial; overflow:hidden; }
#bgVideo { position: fixed; top:0; left:0; width:100%; height:100%; object-fit:cover; z-index:-1; }
.overlay { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.5); z-index:0; }
.content { position: relative; z-index:1; height:100%; display:flex; flex-direction:column; justify-content:center; align-items:center; color:white; text-align:center; }
h1 { font-size:2.5em; margin-bottom:40px; }
.cards { display:flex; gap:30px; flex-wrap:wrap; justify-content:center; }
.card { background: rgba(255,255,255,0.1); border-radius:15px; padding:30px 50px; cursor:pointer; transition:all 0.3s; backdrop-filter:blur(5px); text-transform:uppercase; }
.card:hover { background: rgba(255,255,255,0.2); transform:scale(1.05); }
.modal { position: fixed; top:50%; left:50%; transform: translate(-50%, -50%) scale(0); width:80%; max-width:700px; background: rgba(0,0,0,0.95); padding:40px 30px; border-radius:15px; color:white; z-index:10; transition: transform 0.3s; max-height:90%; overflow-y:auto; backdrop-filter: blur(10px); }
.modal.active { transform: translate(-50%, -50%) scale(1); }
.modal input, .modal select { width:100%; padding:12px; margin-bottom:20px; border-radius:10px; border:none; }
.modal button { padding:12px 25px; margin-right:10px; border:none; border-radius:10px; background:#ff6b6b; color:white; cursor:pointer; }
.modal button:hover { background:#ff4c4c; }
body.modal-open #bgVideo, body.modal-open .overlay, body.modal-open .content { filter: blur(5px); pointer-events: none; user-select: none; }
.resultado { margin-top:20px; display:flex; flex-direction:column; gap:15px; }
.restaurante { background: rgba(255,255,255,0.1); padding:15px; border-radius:10px; display:flex; gap:15px; align-items:center; flex-wrap:wrap; transition: transform 0.3s; }
.restaurante:hover { transform: scale(1.02); }
.restaurante img { width:80px; height:80px; object-fit:cover; border-radius:10px; }
.restaurante div { text-align:left; flex:1; }
.restaurante h3 { margin:0 0 5px 0; }
.restaurante p { margin:0; font-size:0.9em; color:#ddd; }
.restaurante a { display:inline-block; margin-top:5px; padding:5px 10px; background:#25D366; color:white; border-radius:8px; text-decoration:none; font-size:0.9em; }
</style>
</head>
<body>

<video autoplay muted loop playsinline id="bgVideo">
  <source src="fundo.mp4" type="video/mp4">
</video>
<div class="overlay"></div>

<div class="content">
  <h1>ZS Ferramenta</h1>
  <div class="cards">
    <div class="card" id="openModal">Encontrar Cliente</div>
    <div class="card">Criar Novo</div>
    <div class="card">Prompt</div>
  </div>
</div>

<div class="modal" id="clientModal">
  <h2>Qual é o nicho?</h2>
  <input type="text" id="nichoInput" placeholder="Ex.: Padaria, Petshop" />
  <h2>Qual é o estado?</h2>
  <select id="estadoInput">
    <option value="">Selecione o estado</option>
    <option value="SP">São Paulo</option>
    <option value="RJ">Rio de Janeiro</option>
    <option value="MG">Minas Gerais</option>
  </select>
  <div>
    <button id="pesquisarBtn">Pesquisar</button>
    <button id="closeModal">Fechar</button>
  </div>
  <div class="resultado" id="resultadoRestaurantes"></div>
</div>

<script src="https://maps.googleapis.com/maps/api/js?key=SUA_CHAVE_AQUI&libraries=places"></script>
<script>
const openBtn = document.getElementById('openModal');
const closeBtn = document.getElementById('closeModal');
const modal = document.getElementById('clientModal');
const pesquisarBtn = document.getElementById('pesquisarBtn');
const resultadoContainer = document.getElementById('resultadoRestaurantes');

openBtn.addEventListener('click', () => {
  modal.classList.add('active');
  document.body.classList.add('modal-open');
});
closeBtn.addEventListener('click', () => {
  modal.classList.remove('active');
  document.body.classList.remove('modal-open');
  resultadoContainer.innerHTML = "";
});

const estados = {
  "SP": {lat: -23.5505, lng: -46.6333},
  "RJ": {lat: -22.9068, lng: -43.1729},
  "MG": {lat: -19.9167, lng: -43.9345},
};

pesquisarBtn.addEventListener('click', () => {
  const nicho = document.getElementById('nichoInput').value.trim();
  const estado = document.getElementById('estadoInput').value;

  if(!nicho || !estado){
    alert("Preencha o nicho e selecione o estado!");
    return;
  }

  resultadoContainer.innerHTML = "<p>Buscando...</p>";

  const map = new google.maps.Map(document.createElement('div'));
  const service = new google.maps.places.PlacesService(map);

  const location = estados[estado];
  const request = {
    query: `${nicho} em ${estado}`,
    location: new google.maps.LatLng(location.lat, location.lng),
    radius: 50000,
  };

  service.textSearch(request, (results, status) => {
    resultadoContainer.innerHTML = "";
    if (status === google.maps.places.PlacesServiceStatus.OK && results.length) {
      results.forEach(place => {
        const div = document.createElement('div');
        div.classList.add('restaurante');
        const photoUrl = place.photos ? place.photos[0].getUrl({maxWidth:80,maxHeight:80}) : 'https://via.placeholder.com/80';

        // WhatsApp link
        let whatsappLink = '';
        if(place.formatted_phone_number){
          const number = place.formatted_phone_number.replace(/\D/g,''); // remove caracteres
          whatsappLink = `<a href="https://wa.me/55${number}" target="_blank">WhatsApp</a>`;
        }

        div.innerHTML = `
          <img src="${photoUrl}" alt="${place.name}" />
          <div>
            <h3>${place.name}</h3>
            <p>${place.formatted_address || ''}</p>
            <p>Rating: ${place.rating || 'N/A'}</p>
            ${whatsappLink}
          </div>
        `;
        resultadoContainer.appendChild(div);
      });
    } else {
      resultadoContainer.innerHTML = "<p>Nenhum resultado encontrado.</p>";
    }
  });
});
</script>

</body>
</html>
